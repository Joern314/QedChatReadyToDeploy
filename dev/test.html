<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Testinterface</title></head>
<script>

var cursor = 0;

function Init()
{
	request = new XMLHttpRequest();
	var now = new Date();
	uri = "http://chat.qed-verein.de/viewneu.php?channel=&position=-20&limit=1000" +
		"&version=1413235752&type=json&feedback=1&test=" + now.getSeconds();
	request.onreadystatechange = ServerResponse;
	request.open("GET", uri, true);
	request.send();

	request.onreadystatechange = null;
	setTimeout("request.abort()", 10000);
}


function Print(text)
{
	var li = document.createElement("li");
	li.appendChild(document.createTextNode(text));
    document.getElementById("display").appendChild(li);
}

function ServerResponse()
{
	if(request.readyState == 1)
		Print("Verbindung wurde aufgebaut");
	if(request.readyState == 2)
		Print("Anfrage wurde an den Server geschickt");
	if(request.readyState < 3)
		return;

    var end, obj;
    while((end = request.responseText.indexOf(";", cursor)) >= 0)
    {
		Print(request.responseText.substring(cursor, end));
		cursor = end + 1;
	}
	if(request.readyState == 4)
		Print("Verbindung wurde geschlossen");
}
</script>
<body onload="Init()">

<ul id="display">

</ul>
</body>
</html>
